# é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
modular_version/
â”‚
â”œâ”€â”€ ğŸ“Š æ•°æ®ç›¸å…³
â”‚   â”œâ”€â”€ databases/              # æ•°æ®åº“ç›®å½•
â”‚   â”‚   â””â”€â”€ annotation.db       # æ ‡æ³¨æ•°æ®åº“
â”‚   â””â”€â”€ merged_attributes.jsonl # åŸå§‹JSONLæ•°æ®
â”‚
â”œâ”€â”€ âš™ï¸ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ ui_configs/             # UIé…ç½®ç›®å½•
â”‚   â”‚   â””â”€â”€ annotation_config.py # æ ‡æ³¨ä»»åŠ¡UIé…ç½®
â”‚   â””â”€â”€ routes.py               # è·¯ç”±é…ç½®
â”‚
â”œâ”€â”€ ğŸ”§ æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”‚   â”œâ”€â”€ db_models.py        # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ db_handler.py       # æ•°æ®åº“æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ field_processor.py  # å­—æ®µå¤„ç†
â”‚   â”‚   â””â”€â”€ main_multi.py       # ä¸»ç¨‹åºå…¥å£
â”‚   â”‚
â”‚   â””â”€â”€ importers/              # æ•°æ®å¯¼å…¥å™¨
â”‚       â”œâ”€â”€ annotation_importer.py  # æ ‡æ³¨æ•°æ®å¯¼å…¥å™¨
â”‚       â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ ğŸ› ï¸ å·¥å…·ç›®å½•
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ visualization/      # å¯è§†åŒ–å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ view_database.py      # å‘½ä»¤è¡ŒæŸ¥çœ‹å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ view_database_ui.py   # Webå¯è§†åŒ–ç•Œé¢
â”‚   â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ testing/            # æµ‹è¯•å·¥å…·
â”‚   â”‚       â”œâ”€â”€ test_database.py      # æ•°æ®åº“æµ‹è¯•
â”‚   â”‚       â””â”€â”€ README.md
â”‚
â”œâ”€â”€ ğŸ“š æ–‡æ¡£ç›®å½•
â”‚   â””â”€â”€ docs/
â”‚       â”œâ”€â”€ ARCHITECTURE.md     # æ¶æ„æ–‡æ¡£
â”‚       â”œâ”€â”€ DATABASE_GUIDE.md   # æ•°æ®åº“æŒ‡å—
â”‚       â”œâ”€â”€ HOW_TO_ADAPT_NEW_DATA.md  # æ•°æ®é€‚é…æŒ‡å—
â”‚       â””â”€â”€ DATA_FORMAT.md      # æ•°æ®æ ¼å¼è¯´æ˜
â”‚
â”œâ”€â”€ ğŸš€ å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ run_ui.sh              # å¯åŠ¨UIç•Œé¢
â”‚   â””â”€â”€ run.sh                 # æ—§ç‰ˆå¯åŠ¨è„šæœ¬
â”‚
â””â”€â”€ ğŸ“– è¯´æ˜æ–‡æ¡£
    â”œâ”€â”€ README.md              # é¡¹ç›®è¯´æ˜
    â”œâ”€â”€ QUICKSTART.md          # å¿«é€Ÿå¼€å§‹
    â””â”€â”€ STRUCTURE.md           # æœ¬æ–‡æ¡£
```

---

## ğŸ¯ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### é…ç½®ç›¸å…³

- **`ui_configs/annotation_config.py`**: UIé…ç½®ï¼ˆå­—æ®µå®šä¹‰ã€CSSæ ·å¼ç­‰ï¼‰
- **`routes.py`**: è·¯ç”±é…ç½®ï¼ˆå®šä¹‰ä»»åŠ¡æ˜ å°„ï¼‰

### æ ¸å¿ƒåŠŸèƒ½

- **`src/main_multi.py`**: ä¸»ç¨‹åºï¼Œå¯åŠ¨Gradioç•Œé¢
- **`src/db_models.py`**: SQLAlchemyæ•°æ®åº“æ¨¡å‹å®šä¹‰
- **`src/db_handler.py`**: æ•°æ®åº“CRUDæ“ä½œå°è£…
- **`src/field_processor.py`**: å­—æ®µç±»å‹å¤„ç†ï¼ˆæ•°ç»„â†”å­—ç¬¦ä¸²è½¬æ¢ç­‰ï¼‰

### æ•°æ®å¯¼å…¥

- **`importers/annotation_importer.py`**: æ•°æ®å¯¼å…¥å™¨ï¼Œå¯ç›´æ¥è¿è¡Œ

### å·¥å…·é›†

- **`tools/visualization/`**: æ•°æ®åº“å¯è§†åŒ–å·¥å…·
- **`tools/testing/`**: æµ‹è¯•å·¥å…·

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯¼å…¥æ•°æ®

```bash
python -m importers.annotation_importer
```

### 2. å¯åŠ¨UI

```bash
./run_ui.sh --uid user1
```

### 3. æŸ¥çœ‹æ•°æ®ï¼ˆå¯é€‰ï¼‰

```bash
# å‘½ä»¤è¡ŒæŸ¥çœ‹
python tools/visualization/view_database.py --stats

# Webç•Œé¢æŸ¥çœ‹
python tools/visualization/view_database_ui.py
```

### 4. æµ‹è¯•æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰

```bash
python tools/testing/test_database.py
```

---

## ğŸ“Š æ•°æ®æµ

```
åŸå§‹æ•°æ® (merged_attributes.jsonl)
        â†“
    å¯¼å…¥å™¨ (annotation_importer.py)
        â†“
    æ•°æ®åº“ (databases/annotation.db)
        â†“
    UIç•Œé¢ (main_multi.py)
        â†“
    ç”¨æˆ·æ ‡æ³¨
        â†“
    ä¿å­˜å›æ•°æ®åº“
```

---

## ğŸ”§ ç»´æŠ¤ä¸æ‰©å±•

### æ·»åŠ æ–°å­—æ®µ

ç¼–è¾‘ `ui_configs/annotation_config.py` çš„ `FIELD_CONFIG`

### æ·»åŠ æ–°ä»»åŠ¡

1. åˆ›å»º `ui_configs/æ–°ä»»åŠ¡_config.py`
2. åˆ›å»º `importers/æ–°ä»»åŠ¡_importer.py`
3. åœ¨ `routes.py` æ·»åŠ è·¯ç”±é…ç½®

### è‡ªå®šä¹‰UIæ ·å¼

ç¼–è¾‘ `ui_configs/annotation_config.py` çš„ `CUSTOM_CSS`

---

## ğŸ“ æ³¨æ„äº‹é¡¹

- æ•°æ®åº“ä½¿ç”¨ **JSONå­—æ®µ** å­˜å‚¨ä¸šåŠ¡æ•°æ®ï¼Œæ”¯æŒçµæ´»å­—æ®µ
- æ‰€æœ‰å­—æ®µé€šè¿‡ **keyå** è‡ªåŠ¨æ˜ å°„ï¼Œæ— éœ€é¢å¤–é…ç½®
- ä¿®æ”¹é…ç½®åéœ€è¦ **é‡å¯UI** æ‰èƒ½ç”Ÿæ•ˆ

---

**å½“å‰ç‰ˆæœ¬**ï¼šæ•°æ®åº“æ¨¡å¼ï¼Œå•ä»»åŠ¡æ¶æ„ï¼Œæ”¯æŒæ‰©å±•



